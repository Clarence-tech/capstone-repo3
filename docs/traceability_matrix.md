# Metrics & Traceability (NIST SP 800-171 Rev.3)

## 1. SMART Metrics List

### Metric 1: Log Field Minimization Compliance (LFMC)

- **Definition / Formula**  
  LFMC measures how many collected fields match the minimal field set required for analysis.  
  \[
  \text{LFMC} = \frac{\text{minimal fields used}}{\text{total available fields}} \times 100
  \]
- **Data Source**  
  - Output generated by `src/analyze_dataset.py`  
  - Logged in `docs/metrics_summary.txt` and `docs/run_logs/run1.md`
- **Update Cadence**  
  Weekly (or after significant changes)
- **Intended Use**  
  Shows whether only necessary fields are collected, supporting data minimization and
  reducing unnecessary metadata exposure. Aligns with Requirement **3.1.5 – Least Privilege / Data Minimization**.

### Metric 2: Redacted Metadata Coverage (RMC)

- **Definition / Formula**  
  RMC measures how effectively sensitive identifiers are redacted before analysis.  
  \[
  \text{RMC} = \frac{\text{redacted sensitive values}}{\text{total sensitive values detected}} \times 100
  \]
- **Data Source**  
  - Sensitive patterns defined in `docs/redaction_rules.txt`  
  - Redaction results in `docs/metrics_summary.txt`
- **Update Cadence**  
  Weekly
- **Intended Use**  
  Confirms that hostnames, usernames, or other identifiers are removed before processing.
  Supports Requirement **3.3.2 – Audit Record Content**.

### Metric 3: Dataset Processing Integrity Rate (DPIR)

- **Definition / Formula**  
  DPIR measures whether repeated executions of the analysis script produce consistent output.  
  \[
  \text{DPIR} = \frac{\text{number of consistent runs}}{\text{total runs}} \times 100
  \]
- **Data Source**  
  - `docs/dpir_state.json`  
  - `docs/metrics_summary.txt`
- **Update Cadence**  
  Every run
- **Intended Use**  
  Verifies that analysis behaves predictably and that results do not change unexpectedly.
  Supports Requirements **3.3.1 – Audit Log Creation & Integrity** and
  **3.3.5 – Audit Record Retention & Protection**.

### Metric 4: Synthetic Sampling Diversity Index (SSDI)

- **Definition / Formula**  
  SSDI measures how many expected scenario types appear in the dataset.  
  \[
  \text{SSDI} = \frac{\text{observed scenario types}}{\text{expected scenario types}} \times 100
  \]
- **Data Source**  
  - Scenario distribution in `data/sample_data.csv`  
  - Script output in `docs/metrics_summary.txt`
- **Update Cadence**  
  Monthly or whenever the dataset is refreshed
- **Intended Use**  
  Identifies bias caused by under- or over-representing certain event types. Supports
  Requirement **3.11.1 – Risk Assessment**.

---

## 2. Traceability Matrix

| Risk Identified (Weeks 7–8)                                  | NIST SP 800-171 Rev.3 Requirement                              | Metric | Evidence Location                                                |
|--------------------------------------------------------------|-----------------------------------------------------------------|--------|------------------------------------------------------------------|
| Collecting unnecessary log fields that increase exposure     | 3.1.5 – Least Privilege / Data Minimization                    | LFMC   | `src/analyze_dataset.py`; `docs/run_logs/run1.md`               |
| Metadata revealing internal hosts or usernames               | 3.3.2 – Audit Record Content                                   | RMC    | `docs/redaction_rules.txt`; `docs/run_logs/run1.md`             |
| Inconsistent output reducing audit reliability               | 3.3.1 – Audit Logging & Integrity                              | DPIR   | `docs/dpir_state.json`; `docs/metrics_summary.txt`              |
| Dataset bias causing misleading or incomplete conclusions    | 3.11.1 – Risk Assessment                                       | SSDI   | `data/sample_data.csv`; `docs/metrics_summary.txt`              |
| Unsafe or unverifiable handling of log data                  | 3.3.5 – Audit Record Retention & Protection                    | DPIR   | `docs/run_logs/`; `docs/dpir_state.json`                        |

---

## 3. 171A Assessment Statement

Assessment statement from **NIST SP 800-171A Rev.3 — Requirement 3.1.5**:

> **A.03.01.05.a:** Determine if: the organization identifies the minimum set of information necessary to achieve its purpose.

In this project, the LFMC metric and associated evidence (`src/analyze_dataset.py`,
`docs/metrics_summary.txt`, `docs/run_logs/run1.md`) demonstrate how this assessment
statement is addressed.
